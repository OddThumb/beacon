% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Pipe.R
\name{gesd2}
\alias{gesd2}
\title{Detect outliers using robust GESD method}
\usage{
gesd2(x, alpha = 0.05, max_anoms = 0.2, verbose = FALSE)
}
\arguments{
\item{x}{A numeric vector.}

\item{alpha}{A numeric (default: 0.05). Significance level for detecting outliers.}

\item{max_anoms}{A numeric between 0 and 1 (default: 0.2). Maximum fraction of values that may be flagged as outliers.}

\item{verbose}{Logical (default: \code{FALSE}). If \code{TRUE}, returns a detailed outlier report.}
}
\value{
If \code{verbose = FALSE}, returns an integer vector (same length as \code{x}) with 0 for normal values and 1 for outliers.

If \code{verbose = TRUE}, returns a list with:
\describe{
  \item{\code{outlier}}{Binary vector of 0/1 flags.}
  \item{\code{outlier_idx}}{Indices of detected outliers.}
  \item{\code{outlier_vals}}{Values of detected outliers.}
  \item{\code{outlier_direction}}{Direction of anomaly ("Up" or "Down").}
  \item{\code{critical_limits}}{Named vector with lower and upper bounds.}
  \item{\code{outlier_report}}{A tibble summarizing the detection statistics.}
}
}
\description{
Applies the Generalized Extreme Studentized Deviate (GESD) test for detecting one or more outliers
in a univariate numeric vector, using a robust formulation with median and MAD.
}
\details{
This function implements a robust version of the GESD procedure, replacing mean and standard deviation
with median and MAD (median absolute deviation), as commonly used in anomaly detection for heavy-tailed or skewed data.

At each iteration, it removes the most extreme observation (with highest robust z-score), recalculates the test statistic,
and compares it to a dynamically computed critical value. Observations are reported as outliers only if their z-statistics
exceed the threshold.

This implementation is adapted from \pkg{anomalize}'s \code{gesd()} method. The return type has been simplified to use binary
flags (1 = outlier, 0 = normal), and the function is implemented without using pipe operators for clarity and compatibility.
}
\references{
Adapted from \code{anomalize::gesd()}:
\url{https://business-science.github.io/anomalize/reference/gesd.html}

Original method: Rosner, B. (1983). “Percentage points for a generalized ESD many-outlier procedure.” Technometrics.
}
